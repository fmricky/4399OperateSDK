4399运营SDK服务端接入说明
===============

## 充值回调接口
### 接口说明
用户充值成功后，4399运营SDK（以下简称SDK）服务端将充值信息回调到游戏方服务端，游戏方服务端应在5秒内返回充值结果，否则将判定订单为异常订单。
只有确认订单是失败的情况下，才返回失败的返回值，当充值中心收到失败的返回值时，将退还用户的充值金额到游币账户，此后若该笔订单在游戏里又处理成充值成功，将造成充值金额的损失。

### 接口定义
- 接口名称：充值回调接口
- 接口描述：用户充值时，手机平台将请求本接口通知游戏方进行充值
- 接口协议：GET 
- 接口开发：游戏方

### 请求参数
   字段    |   必填    |   数据类型    |   说明    
-----------|-----------|---------------|-----------
orderid | 是|string|(4399生成的订单号) 22位以内的字符串 唯一
p_type|是|int|充值渠道id
uid|是|int|要充值的用户ID，my平台的用户uid 
money|是|float|充值金额人民币，单位：元
gamemoney|是|int|兑换的游戏币数量，兑换标准由双方共同约定，若在标准兑换比率基础上，有一些优惠或者赠送策略，可无视此数据，由应用端自行计算实际的兑换数额
serverid|否|int|要充值的服务区号。只针对有分服的游戏有效。参数的格式为：区服id。 例如 1服 为 1,  11服为 11
mark|否|string|作为预留字段，部分游戏在游戏内发起充值时，会生成唯一标识来标注该笔充值的相关信息时，可以用本字段。（游戏方生成的订单号）
roleid|否|int|要充值的游戏角色id，只针对pc端充值时，需要选择游戏角色的游戏有效。roleid的值由角色接口提供（见接口2）
time|是|int|发起请求时的时间戳
sign|是|strin|加密签名，签名计算为：`$sign` = md5(`$orderid` . `$uid` . `$money` . `$gamemoney` . `$serverid` . `$secret` . `$mark` . `$roleid`.`$time`);

注：
1. 参与签名的所有参数为接受到的原始参数，请不要在参与签名计算前对参数做任何处理  
2. 使用标准`MD5`算法对该字符串加密  
3. `$secret` 为双方约定的密钥  
4. `$serverid` ,   `$mark` ,   `$roleid`  这三个参数为空时，即不参与签名计算，无需做特殊处理  

### 返回结果
返回值
```json
{
    "status":{status},
    "code":{code},
    "money":{money},
    "game_money":{gamemoney},
    "msg":{message}
}
```

返回值说明
 `status`：

- `1`：异常
- `2`：成功
- `3`：失败（将钱返还给用户）

`code`:异常状态码，成功或失败为空

- `sign_error`：请求串的md5验证码错误
- `user_not_exist`：用户账号不存在
- `orderid_exist`：订单已提交（提交订单号必须唯一)
- `money_error`：充值金额或兑换游戏币数量错误，充值金额为正整数，需符合双方约定的兑换标准
- `other_error`：其他错误  
  
`money`：用户兑换的游币数量
`gamemoney`：用户实际兑换的游戏币的数量
`message`:开发商自定义的内容（返回结果的说明等）

